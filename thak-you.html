<?php

if ($_SERVER["REQUEST_METHOD"] !== "POST") {
    header("Location: index.html");
    exit;
}

// CONFIG
$admin_email = "info@gsgroupservices.co.uk";
$from_email  = "contact@gsgroupservices.co.uk";
$site_name   = "GS Group Services";

// SANITIZE INPUT
function clean($data) {
    return htmlspecialchars(strip_tags(trim($data)));
}

$name     = clean($_POST["name"] ?? "");
$email    = clean($_POST["email"] ?? "");
$phone    = clean($_POST["phone"] ?? "");
$service  = clean($_POST["service"] ?? "");
$location = clean($_POST["location"] ?? "");
$message  = clean($_POST["message"] ?? "");

// BASIC VALIDATION
if (!$name || !$email || !$phone || !$service) {
    die("Missing required fields.");
}

// EMAIL TO ADMIN
$subject = "New Quote Request – $service";

$body = "
New quote request from GS Group Services website

Name: $name
Email: $email
Phone: $phone
Service: $service
Location: $location

Message:
$message
";

$headers  = "From: $site_name <$from_email>\r\n";
$headers .= "Reply-To: $email\r\n";
$headers .= "Content-Type: text/plain; charset=UTF-8\r\n";

mail($admin_email, $subject, $body, $headers);

// AUTO-REPLY TO CLIENT
$reply_subject = "We received your quote request – GS Group Services";
$reply_body = "
Hi $name,

Thank you for contacting GS Group Services.

We have received your request for:
$service

Our team will contact you shortly.

Phone: 07440 184221
Email: info@gsgroupservices.co.uk
Website: https://gsgroupservices.co.uk

Kind regards,
GS Group Services
";

$reply_headers  = "From: $site_name <$from_email>\r\n";
$reply_headers .= "Reply-To: $admin_email\r\n";
$reply_headers .= "Content-Type: text/plain; charset=UTF-8\r\n";

mail($email, $reply_subject, $reply_body, $reply_headers);

// REDIRECT TO THANK YOU
header("Location: thank-you.html");
exit;
